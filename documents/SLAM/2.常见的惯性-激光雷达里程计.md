# 2. 常见的惯性-激光雷达里程计（LIO）

> 本节面向工程实践，梳理 **FAST‑LIO / FAST‑LIO2、Point‑LIO、Faster‑LIO** 三种主流 IMU‑LiDAR 里程计算法的核心思想、系统架构、优缺点与选型建议。文末给出落地要点与参数提示。

---

## 2.1 背景与术语

* **LIO（LiDAR‑Inertial Odometry）**：紧耦合利用 IMU 的高频短时运动约束与 LiDAR 的低频几何约束，输出高精度位姿并构建局部地图。
* **带宽（odometry bandwidth）**：里程计**输出频率**与**响应速度**的综合，决定控制与规划端可感知的实时性。
* **i(E)KF / ESKF / iKFOM**：迭代扩展卡尔曼滤波族（滤波式前端），与**图优化**不同；FAST‑LIO/Point‑LIO/Faster‑LIO均属**滤波范式**。
* **点到面残差（point‑to‑plane）**：常见的 LiDAR 观测模型；与地图（KD‑Tree/体素）中局部平面拟合做匹配。
* **ikd‑Tree / iVox**：分别是**增量 KD‑Tree**与**增量稀疏体素**的地图/近邻数据结构，决定建图内存与匹配效率。

---

## 2.2 FAST‑LIO / FAST‑LIO2

### 核心思想

* 以**紧耦合 iEKF**为框架，将每个 LiDAR 点的几何残差与 IMU 预积分一起进入滤波更新；
* **FAST‑LIO2**进一步做到**直接对原始点云配准（无手工特征）**，并以 **ikd‑Tree** 做**增量地图与快速近邻**；
* 提出计算卡尔曼增益的高效公式，使复杂度主要依赖**状态维度**而非**观测维度**，从而在大量点云下仍能实时。

### 系统构成

* **状态**：位姿、速度、IMU 零偏（可选重力方向等）。
* **地图**：滑动窗口局部地图，ikd‑Tree 支持**插入/删除/盒查询**与**延迟重平衡**，地图随 FOV 迁移。
* **传感器**：兼容旋转式（Velodyne/Ouster 等）与固态 LiDAR（Livox 系列），支持外部 IMU。

### 工程优缺点

* **优点**：成熟稳健、对纹理退化环境鲁棒；跨雷达型号易用；社区案例多。
* **潜在问题**：

  * ikd‑Tree 在**低频大量点**批量插入场景可能不如静态 KD‑Tree 高效；
  * 仍以\*\*(子)帧为单位**组织更新，极端高速/激烈机动下的**帧内畸变\*\*与响应带宽有限（但已优于传统法）。

### 何时选 FAST‑LIO2

* 通用场景的**稳健首选**；UGV/UAV 常规机动、自动驾驶原型、异构 LiDAR 快速集成。

---

## 2.3 Point‑LIO

### 核心思想

* **逐点更新（point‑by‑point）**：不再累计成帧，而是**每个 LiDAR 点到达就触发一次滤波更新**，

  * 消除**帧内运动畸变**；
  * 将里程计输出频率提升到**kHz 等级**（高带宽），使控制/规划更“跟手”。
* **随机过程增强的运动模型**：将 IMU 测量视作模型的**输出**而非输入，在**IMU 饱和/强振动**下仍稳定估计。
* 地图/近邻通常仍采用 **ikd‑Tree**，但以“点到面”逐点残差驱动滤波。

### 工程优缺点

* **优点**：

  * 极高**带宽与响应**，对**激烈机动**（竞速无人机、自旋载体）与**强振动**更鲁棒；
  * 更自然的时域处理，减少插值与去畸变依赖。
* **注意事项**：

  * 极高更新频率意味着对**时间同步、外参、IMU 噪声建模**更敏感；
  * 官方实现以 ROS1 为主，社区 ROS2 版本质量参差，部署需谨慎评估；
  * 计算与内存压力随点密度上升，需要合理**下采样/分区**与地图半径控制。

### 何时选 Point‑LIO

* \*\*追求控制环“高带宽/低延迟”\*\*的场景：竞速/高动态 UAV、带强振动的轻量平台；
* 固态 LiDAR（高点频）+ 高刷 IMU 组合。

---

## 2.4 Faster‑LIO

### 核心思想

* 面向**更高实时性与更低内存**，将地图结构由 ikd‑Tree 替换为**增量稀疏体素 iVox**：

  * 提供 \*\*linear iVox / iVox‑PHC（伪希尔伯特曲线）\*\*两种实现；
  * 在**大规模点云**下保持高效增删与近邻；
  * 搭配**并行 kNN/匹配**，整体速度可显著超越 FAST‑LIO2。

### 工程优缺点

用过但是感觉没啥明显缺点。